---
title: "メールを元にカレンダーに予定を自動生成する"
emoji: "⏰"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---
# 何をしたのか
- 予約及びキャンセルのメールからカレンダーの予定を自動修正
  - スポーツジム
  - ゴルフレッスン
- 週次及び月次で自動入力されている予定の数をslackに通知

# はじまり
一人で打ちっぱなしに行ってる分には全然上達していないことに気づき、オープン記念で会費が下がっていた[アースゴルフアカデミー](https://earthgolf.jp/)に入会する。

月額制、通い放題のため、割と頻繁に通うものの、ゴルフレッスンの予約をカレンダーに手作業で入れるのが面倒になる。
要因としては、他の会員がキャンセルして空いた枠に変えたい等の理由でキャンセルしてから予約し直すことも多いことが挙げられる。

予約、キャンセルの通知メールはテンプレートなのだから、カレンダーに自動的に予定を作成してくれてもいいのに…と思ったものの、
終了時刻が記載されてないせいか自動的に作成はしてくれなかった。

ダメなら自分で書けばいいんじゃないのかと思って、調べてみたらできそうだったので、GASにはじめて触ることにした。

# メールからカレンダーに予定を作成し、削除する
GASを触ってみるにあたって、[GASを使ってGmailにきた予定をGoogle Calendarに自動で登録する](https://aakira.app/blog/2021/01/gas-gmail-to-calendar/)を参考にしました。

## GASを作成する
1. Google Driveを開く
1. 新規 > その他 > Google Apps Scriptを選ぶ

## 初回実行時に権限を許可する
1. `実行`をクリック
1. `権限を確認`をクリック
1. 適切なアカウントを選択
1. `詳細`をクリック
1. `<プロジェクト名>（安全でないページ）に移動`をクリック
1. `<プロジェクト名>が Google アカウントへのアクセスをリクエストしています`と表示されるので、`許可`をクリック

## 予約メールから自動的に予定を作成する

## トリガーをセットする
実行する関数は`main`のままで、イベントのソースを`時間主導型`とする。

メールを受信するごとにトリガーできないため、このような対応となっている。

# Ref.
1. [GASを使ってGmailにきた予定をGoogle Calendarに自動で登録する](https://aakira.app/blog/2021/01/gas-gmail-to-calendar/)
